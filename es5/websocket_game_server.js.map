{"version":3,"sources":["websocket_game_server.js"],"names":["start","preferences","startOrContinue","console","log","buzzer","type","get_teensy_buzzer","get_ps2_buzzer","get_websocket_buzzer","gameUI","game","port","masterUI","master","questions_directory","HID","require","device","e","Error","message","prefs"],"mappings":"AAAA;;;;;QASgBA,K,GAAAA,K;;AAPhB;;AACA;;AAEA;;AACA;;AACA;;AAEO,SAASA,KAAT,CAAeC,WAAf,EAA4BC,eAA5B,EAA6C;AACnDC,SAAQC,GAAR,CAAY,eAAZ,EAA6BH,WAA7B;AACA,KAAII,MAAJ;AACA,SAAOJ,YAAYI,MAAZ,CAAmBC,IAA1B;AACC,OAAK,QAAL;AACCH,WAAQC,GAAR,CAAY,YAAZ;AACAC,YAASE,mBAAT;AACAJ,WAAQC,GAAR,CAAY,KAAZ;AACA;AACD,OAAK,KAAL;AACCC,YAASG,gBAAT;AACA;AACD,OAAK,WAAL;AACCH,YAASI,qBAAqBR,YAAYI,MAAjC,CAAT;AACA;AACD;AACCF,WAAQC,GAAR,CAAY,OAAZ;AAbF;;AAgBAD,SAAQC,GAAR,CAAY,QAAZ;AACA,KAAIM,SAAS,8BAAgBT,YAAYU,IAAZ,CAAiBC,IAAjC,CAAb;AACA,KAAIC,WAAW,8BAAgBZ,YAAYa,MAAZ,CAAmBF,IAAnC,CAAf;AACA,KAAID,OAAO,eAASN,MAAT,EAAiBK,MAAjB,EAAyBG,QAAzB,EAAmCZ,YAAYU,IAAZ,CAAiBI,mBAApD,EAAyEb,eAAzE,CAAX;AACAC,SAAQC,GAAR,CAAY,mBAAZ;AACA,QAAOO,IAAP;AACA;;AAED,SAASH,cAAT,GAA0B;AACzB,KAAIH,SAAS,IAAb;AACA,KAAI;AACH,MAAIW,MAAMC,QAAQ,UAAR,CAAV;AACA,MAAIC,SAAS,IAAIF,IAAIA,GAAR,CAAY,MAAZ,EAAoB,MAApB,CAAb;AACAX,WAAS,kBAAca,MAAd,CAAT;AACA,EAJD,CAIE,OAAMC,CAAN,EAAS;AACV,QAAM,IAAIC,KAAJ,CAAU,uBAAqBD,EAAEE,OAAjC,CAAN;AACA;AACD,QAAOhB,MAAP;AACA;;AAED,SAASE,iBAAT,GAA6B;AAC5BJ,SAAQC,GAAR,CAAY,8BAAZ;AACA,QAAO,0BAAP;AACA;;AAED,SAASK,oBAAT,CAA8Ba,KAA9B,EAAqC;AACpC,QAAO,+BAAoBA,MAAMV,IAA1B,CAAP;AACA","file":"websocket_game_server.js","sourcesContent":["'use strict';\n\nimport { WebsocketUI } from './websocket_ui'\nimport { Game } from './game'\n\nimport { TeensyBuzzer } from 'node-buzzer/es5/teensy'\nimport { Ps2Buzzer } from 'node-buzzer/es5/ps2'\nimport { WebsocketBuzzer } from 'node-buzzer/es5/websocket'\n\nexport function start(preferences, startOrContinue) {\n\tconsole.log('start game : ', preferences);\n\tvar buzzer;\n\tswitch(preferences.buzzer.type) {\n\t\tcase 'teensy':\n\t\t\tconsole.log('teeeeeensy')\n\t\t\tbuzzer = get_teensy_buzzer();\n\t\t\tconsole.log('got')\n\t\t\tbreak;\n\t\tcase 'ps2':\n\t\t\tbuzzer = get_ps2_buzzer();\n\t\t\tbreak;\n\t\tcase 'websocket':\n\t\t\tbuzzer = get_websocket_buzzer(preferences.buzzer);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconsole.log('error');\n\t}\n\t\n\tconsole.log('uis...')\n\tvar gameUI = new WebsocketUI(preferences.game.port)\n\tvar masterUI = new WebsocketUI(preferences.master.port)\n\tvar game = new Game(buzzer, gameUI, masterUI, preferences.game.questions_directory, startOrContinue)\n\tconsole.log('Server started...')\n\treturn game;\n}\n\nfunction get_ps2_buzzer() {\n\tvar buzzer = null;\n\ttry {\n\t\tvar HID = require('node-hid');\n\t\tvar device = new HID.HID(0x054c, 0x1000);\n\t\tbuzzer = new Ps2Buzzer(device);\n\t} catch(e) {\n\t\tthrow new Error(\"No buzzer found : \"+e.message);\n\t}\n\treturn buzzer;\n}\n\nfunction get_teensy_buzzer() {\n\tconsole.log('build TeensyBuzzer object...')\n\treturn new TeensyBuzzer();\n}\n\nfunction get_websocket_buzzer(prefs) {\n\treturn new WebsocketBuzzer(prefs.port);\n}"]}